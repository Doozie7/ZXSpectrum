10 REM ZX Spectrum Roman Numerals Calculator
20 CLS
30 PRINT "ROMAN NUMERAL CALCULATOR"
40 PRINT "------------------------"
50 PRINT "Enter first number (Roman): ";
60 INPUT A$
70 LET A = ROMAN_TO_DECIMAL(A$)
80 PRINT "Enter second number (Roman): ";
90 INPUT B$
100 LET B = ROMAN_TO_DECIMAL(B$)
110 PRINT "Enter operation (+, -, *, /): ";
120 INPUT OP$
130 LET RESULT = 0
140 IF OP$ = "+" THEN LET RESULT = A + B
150 IF OP$ = "-" THEN LET RESULT = A - B
160 IF OP$ = "*" THEN LET RESULT = A * B
170 IF OP$ = "/" THEN IF B = 0 THEN PRINT "DIV BY 0 ERROR": STOP
180 IF OP$ = "/" THEN LET RESULT = INT(A / B)
190 PRINT "RESULT: "; RESULT
200 PRINT "IN ROMAN: "; DECIMAL_TO_ROMAN(RESULT)
210 STOP

220 REM Convert Roman numeral to decimal
230 DEF FN ROMAN_TO_DECIMAL(X$)
240 LET X$ = UPPER$(X$)
250 LET VALUE = 0
260 LET PREV = 0
270 FOR I = LEN(X$) TO 1 STEP -1
280 LET C$ = MID$(X$, I, 1)
290 LET V = 0
300 IF C$ = "I" THEN LET V = 1
310 IF C$ = "V" THEN LET V = 5
320 IF C$ = "X" THEN LET V = 10
330 IF C$ = "L" THEN LET V = 50
340 IF C$ = "C" THEN LET V = 100
350 IF C$ = "D" THEN LET V = 500
360 IF C$ = "M" THEN LET V = 1000
370 IF V < PREV THEN LET VALUE = VALUE - V ELSE LET VALUE = VALUE + V
380 LET PREV = V
390 NEXT I
400 RETURN VALUE

410 REM Convert decimal to Roman numeral
420 DEF FN DECIMAL_TO_ROMAN(N)
430 IF N <= 0 THEN RETURN "INVALID"
440 LET R$ = ""
450 DIM RN$(13), RV(13)
460 DATA "M",1000,"CM",900,"D",500,"CD",400,"C",100,"XC",90,"L",50,"XL",40,"X",10,"IX",9,"V",5,"IV",4,"I",1
470 FOR I = 1 TO 13
480 READ RN$(I), RV(I)
490 WHILE N >= RV(I)
500 LET R$ = R$ + RN$(I)
510 LET N = N - RV(I)
520 END WHILE
530 NEXT I
540 RETURN R$

550 REM End of program
